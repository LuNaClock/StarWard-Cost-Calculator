# 星の翼 総合耐久・覚醒シミュレーター

## 概要

このツールは、ゲーム「星の翼」における戦闘シミュレーションを支援するウェブアプリケーションです。主な機能として、以下の計算・予測が可能です。

*   **キャラクターごとのコストオーバー耐久値計算:** 各キャラクターがコストオーバー状態で再出撃した際の耐久値を、残りチームコストに応じて一覧表示します。
*   **再出撃シミュレーション:** 選択した自機と相方のチーム編成に基づき、指定した残りチームコストでどちらかの機体が再出撃した場合の耐久値とHPバーをシミュレーションします。
*   **覚醒ゲージ予測:** 再出撃シミュレーションと連動し、撃墜前の状況（残りHP、覚醒ゲージ残量）や各種ボーナス（自機撃墜、与ダメージ、相方撃墜）を考慮して、再出撃後の覚醒ゲージ到達量を予測します。
*   **チーム合計耐久力予測:** 選択した自機と相方のペアで、様々な撃墜シナリオ（理想、妥協、爆弾、最低）を想定した場合のチーム全体で獲得できる総耐久力を予測し、詳細な撃墜順序も表示します。

本ツールは、直感的な操作と視覚的なフィードバックを通じて、プレイヤーの戦略立案をサポートします。

## 実行方法

下記URLにて実装内容が確認いただけます。

https://lunaclock.github.io/StarWard-Cost-Calculator/

`index.html` ファイルをウェブブラウザで開くことでも動作しますが、完全な動作にはローカルウェブサーバーをたちあげる必要があります。
例えばVisual Studio Codeであれば「Live Server」などの拡張機能を入れる事で実行可能です。

## 主な機能

### 1. 基本的なコストオーバー耐久値計算機能

*   **計算式:** 再出撃時の耐久値 = 本来の耐久値 × (残りコスト ÷ キャラクターのコスト)
    *   ただし、残りコストがキャラクターのコスト以上の場合、耐久値は本来の耐久値（100%）となります。
    *   残りコストが0の場合、耐久値は0となります。
*   **チーム総コスト上限:** 6.0として計算されます。
*   **残りコストの表示:** 各キャラクターのコストに応じて、ゲームシステム上実現可能な残りコストの組み合わせで計算結果を表示します。

### 2. 表示機能

*   各キャラクター名、本来の耐久値、コストの表示。
*   キャラクターアイコンの表示（一部キャラクターはイニシャル表示）。
*   コストオーバー時の耐久値をキャラクターカード内の表形式で表示。
*   HPバーによる耐久値の視覚的表示と、クリックによるシミュレーション。
    *   低HP時にはHPバーにパルスアニメーションが適用されます。
*   SF風のUIデザイン、アニメーション、ローディングインジケーター。

### 3. 検索・フィルタリング・ソート機能

*   **キャラクター名検索:**
    *   部分一致検索。
    *   ひらがな、カタカナでの入力にも対応。
*   **コスト別フィルタリング:** 「全て」、コスト「1.5」「2.0」「2.5」「3.0」で絞り込み可能。
*   **並び替え機能:** 「名前順」、「耐久値(昇順/降順)」、「コスト(昇順/降順)」でソート可能。

### 4. 再出撃シミュレーション機能

*   **入力:**
    *   自機と相方のキャラクターをドロップダウンから選択。
    *   チーム合計コストを自動計算して表示。
    *   指定キャラクター撃墜後のチーム残り総力コストを入力。
*   **実行:** 「自機が再出撃した場合」「相方が再出撃した場合」ボタンでシミュレーション開始。
*   **結果表示:**
    *   再出撃機体名、機体コスト、本来の耐久値。
    *   再出撃時に消費するコスト。
    *   計算された再出撃時耐久値。
    *   HPバーとパーセンテージによる視覚的な耐久値表示。
    *   選択された機体のミニカード表示（アイコン、名前、コスト）。

### 5. 覚醒ゲージ予測機能 (再出撃シミュレーション結果と連動)

*   **入力:**
    *   「覚醒が溜まるか調べたい覚醒ゲージ」: 撃墜される直前の、再出撃する機体の覚醒ゲージ残量(%)。
    *   「覚醒が溜まるか調べたい耐久値」: 撃墜される直前の、再出撃する機体の残りHP。この値と最大HPから被ダメージ量を計算し、ゲージ増加に反映。
*   **オプション (チェックボックスで選択):**
    *   「再出撃直後のゲージ量にする」: 自機/相方が撃墜された際に得られるコストに応じた覚醒ゲージボーナスを加算。
    *   「与ダメージ考慮」: 撃墜されるまでに与えたダメージによる覚醒ゲージ増加分を任意で追加（ドロップダウンで選択）。
    *   「相方撃墜考慮」: 相方が既に撃墜されている場合に得られる覚醒ゲージボーナスを加算。
*   **結果表示:**
    *   予測覚醒ゲージ量(%)。
    *   覚醒使用可否（予測ゲージが50%以上で使用可能と判定）。

### 6. チーム合計耐久力予測機能

*   自機と相方を選択すると自動で計算・表示。
*   **予測シナリオ:**
    *   **チーム合計耐久値(最高):** 高コスト機が先に撃墜 → 次に低コスト機が撃墜 → その後の再出撃を最適化した場合のチーム総耐久力。
    *   **チーム合計耐久値(妥協):** 低コスト機が先に撃墜 → 次に高コスト機が撃墜 → その後の再出撃を最適化した場合のチーム総耐久力。
    *   **チーム合計耐久値(爆弾):** 編成内の低コスト機のみが連続して撃墜された場合のチーム総耐久力。
    *   **チーム合計耐久値(最低):** どちらか一方の機体のみが集中して連続撃墜された場合、より総耐久力が低くなる方のシナリオ。
*   **表示:**
    *   各シナリオの合計獲得耐久値。
    *   アコーディオン形式で、各シナリオの詳細な撃墜順序と各段階での獲得HP、残りチームコストを表示。

## 使用方法

1.  **基本操作 (キャラクターカード):**
    *   `index.html` ファイルをブラウザで開きます。
    *   上部の検索ボックスにキャラクター名（一部、ひらがな、カタカナ可）を入力すると、該当キャラクターが絞り込まれます。
    *   「コスト」ボタンで表示キャラクターをコスト別にフィルタリングできます。
    *   「並び替え」ボタンで表示順を変更できます。
    *   各キャラクターカード内の「再出撃時耐久値」のセルをクリックすると、その耐久値がHPバーに反映され、割合も表示されます。
    *   キャラクターカードの「本来の耐久値」の数値部分をクリックすると、HPバー表示が100%にリセットされます。
    *   「ツールの使い方ガイド」アコーディオンで各機能の概要を確認できます。

2.  **再出撃シミュレーション:**
    1.  「再出撃シミュレーション」セクションに進みます。
    2.  「自機」と「相方」をそれぞれのドロップダウンメニューから選択します。
    3.  「チーム合計コスト」が自動表示され、選択した機体のミニカードが表示されます。
    4.  「指定キャラ撃墜後の残りコスト」を入力します（チームの総力ゲージがこの値になる状況を想定）。
    5.  「自機が再出撃した場合」または「相方が再出撃した場合」ボタンをクリックすると、結果エリアに予測耐久値などが表示されます。
    6.  任意で、結果エリア内の「覚醒ゲージ予測」セクションで撃墜直前の状況（覚醒ゲージ残量、残りHP）を入力し、オプションを選択することで、再出撃後の覚醒ゲージ量を予測できます。

3.  **チーム合計耐久力予測:**
    1.  「再出撃シミュレーション」セクションで自機と相方を選択すると、「チーム合計耐久力予測」セクションに自動で4つのシナリオに基づいた計算結果が表示されます。
    2.  各シナリオ（最高、妥協、爆弾、最低）の「合計獲得耐久値」を確認します。
    3.  各シナリオ下の「撃墜順序と獲得HP」と書かれたアコーディオンヘッダーをクリックすると、そのシナリオにおける詳細な撃墜の進行と、各段階での獲得HP、残りチームコストの内訳を確認できます。

## 技術仕様

*   HTML5 / CSS3 / JavaScript
*   レスポンシブデザイン（スマートフォン、タブレット、PCに対応）
*   ローカルでの実行（外部API依存なし、サーバー不要）

## 将来の拡張可能性

*   より詳細なゲーム内データ（武装、特殊能力など）の取り込みと、それに基づいた高度なシミュレーション機能。
*   チーム編成の保存・読み込み・共有機能。
*   UI/UXのさらなる向上。
*   ゲームのアップデートに合わせたデータや計算ロジックの継続的なメンテナンス。

## 参考資料

*   覚醒ゲージシステム検証 (他ゲーム参考): アヒャッポゥのブログ [https://www.dragonicfighter.net/entry/2021/10/12/090336](https://www.dragonicfighter.net/entry/2021/10/12/090336)
    *   (注: 本ツールの覚醒ゲージ計算は「星の翼」の仕様に基づいていますが、上記記事の検証アプローチを参考にさせていただきました。)

---
© 2025 Lu:Na:Clock

![CodeRabbit Pull Request Reviews](https://img.shields.io/coderabbit/prs/github/LuNaClock/StarWard-Cost-Calculator?utm_source=oss&utm_medium=github&utm_campaign=LuNaClock%2FStarWard-Cost-Calculator&labelColor=171717&color=FF570A&link=https%3A%2F%2Fcoderabbit.ai&label=CodeRabbit+Reviews)
